from django.shortcuts import render
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from .serializers import BarcodeCountSerializer,EmployeeTSerializer,ProductsTSerializer,TypeTSerializer
from .models import EmployeeT,ProductsT,TypeT
import random

class GenerateBarcodeView(APIView):
    def get(self, request):
        barcode_type=TypeT.objects.all() 
        serializer=TypeTSerializer(barcode_type,many=True)
        return Response({"message":"GET SUCCESSFUL"},status=status.HTTP_200_OK)
 
   def post(self, request):
       serializer=BarcodeCountSerializer(data=request.data)
       if serializer.is_valid():
            number_of_barcodes = serializer.validated_data['number_of_barcodes']
            pname=request.data.get('Product Name')
            psize=request.data.get('Product Size')
            ptype=request.data.get('Product Type')
            seller=request.data.get('Seller')
            pamount=request.data.get('Amount')
            valid_type_instance=get_object_or_404(TypeT, pname=pname, psize=psize, ptype=ptype, pseller=seller, pamount=pamount) 
            if valid_type:
                prefix=valid_type.b_type 
                barcode = generate_barcode(prefix,number_of_barcodes)
                for barcode in barcodes:
                    
                 
